# KTOR

Ktor — это асинхронная платформа для создания микросервисов, веб-приложений и многого другого, написанная на Kotlin.

В общем это как спринг, только более легковесное и бедное что ли... В целом напиминает гошные фреймворки. Для микросервисов или домашек ок, что-то большое я бы писать на нем не стал.

## Создание проекта

В целом все стандартно, выбираем шаблок ктор, билд систему, версию ктора. Потом мы подходим к выбору веб сервера который будет использоваться фреймворком. Как будто дефолтный нетти - в большинстве случаев оптимальный выбор с точки зрения соотношения перфоманса/геморроя. Ну а конфигурацию и вовсе можете делать на свой вкус, проще всего наверное все настроить в коде, но тогда вы теряете некоторую гибкость в изменении конфигурации, поэтому в реалдьности ее обычно стараются максимально вынести в отдельные файлы.

## API

API (Application programming interface) — это контракт, который предоставляет программа.

### REST API (Representational State Transfer)

REST API является наиболее распространенным типом API в клиент-серверной архитектуре и имеет ряд свойств — например, отсутствие хранения состояния и кэшируемость. REST API построен на стандартных протоколах HTTP и обычно возвращает данные в формате JSON, хотя может поддерживать и другие форматы.

REST API использует стандартные HTTP-методы для взаимодействия, включая GET, POST, PUT, DELETE и другие. Каждый метод соответствует определенному типу действий, которые могут быть выполнены над ресурсами API.

Простота и гибкость REST API сделали его лучшим выбором для многих разработчиков, но при работе с большими объемами данных он может быть неэффективными, так как для получения всех необходимых данных может требоваться несколько запросов.

### SOAP API (Simple Object Access Protocol)

SOAP — это протокол для обмена структурированной информацией в веб-сервисах с использованием XML. Он обладает высокой расширяемостью и позволяет осуществлять обмен данными через несколько различных транспортных протоколов, включая HTTP, SMTP и другие.

API SOAP известны своей надежностью и часто используются в энтерпрайз-разработке. Они предлагают встроенную обработку ошибок и их можно использовать с различными сетевыми протоколами. Однако зависимость SOAP от XML может приводить к большим объемам передаваемых данных, что делает его менее эффективным по сравнению с другими API в каких-то сценариях использования.

### WebSocket API

WebSocket API обеспечивает постоянный, полнодуплексный канал связи между клиентом и сервером. В отличие от REST и SOAP, которые придерживаются формата «запрос-ответ», WebSocket сохраняет соединение открытым, что позволяет передавать данные в режиме реального времени. Это делает WebSocket API идеальным для приложений, требующих функциональности в реальном времени, таких как чат-приложения, онлайн-игры и системы отслеживания в реальном времени.

Несмотря на свою мощь, WebSocket API могут быть более сложными в реализации и требуют больше ресурсов для поддержания открытых соединений.

### gRPC API (Google Remote Procedure Call)

gRPC — это высокопроизводительная платформа с открытым исходным кодом, разработанная компанией Google. Он использует протокол HTTP/2 для передачи данных и Protocol Buffers (protobuf), высокопроизводительный формат двоичных данных, в качестве языка определения интерфейса.

gRPC поддерживает четыре типа взаимодействия: унарный (стандартный запрос-ответ), потоковая передача данных с сервера, потоковая передача данных от клиента и двунаправленная потоковая передача. Эти возможности в сочетании с эффективностью делают gRPC идеальным решением для микросервисной архитектуры.

### GraphQL API 

Разработанный компанией Facebook, GraphQL представляет собой язык запросов к API и рабочую среду для выполнения этих запросов. В отличие от REST API, где вам нужно делать запросы к различным эндпоинтам, чтобы получить соответствующие данные, GraphQL позволяет сделать один единственный запрос, чтобы получить именно те данные, которые вам нужны.

В GraphQL пользователи определяют форму и размер ответа, что приводит к более эффективной загрузке данных и уменьшению избыточной выборки данных. Он отлично подходит для сложных систем и микросервисов, где данные распределены между различными сервисами.

## Протоколы

Протокол – это набор правил, определяющий, как узлы сети должны передавать данные друг другу.

Транспортный уровень основан на двух китах: Transmission Control Protocol и User Datagram Protocol

TCP/IP — это аббревиатура, которая обозначает два основных протокола, используемых в этой модели: протокол передачи контроля соединения (TCP) и протокол интернет-протокола (IP). TCP обеспечивает установление соединения между устройствами, управление потоком данных и контроль ошибок, а IP отвечает за передачу пакетов данных между устройствами в сети.

TCP/IP модель состоит из четырех уровней:

* Канальный уровень
* Межсетевой уровень
* Транспортный уровень
* Прикладной уровень

Канальный уровень отвечает за передачу данных по физической среде, он нас не интересует.

Межсетевой уровень отвечает за маршрутизацию пакетов данных между разными сетями.

Транспортный уровень обеспечивает эффективную передачу данных между устройствами в сети. На этом уровне используются протоколы, такие как TCP и UDP. TCP обеспечивает установление соединения между устройствами, контроль потока данных и обработку ошибок, а UDP предоставляет более быструю передачу данных без управления потоком и ошибками.

Прикладной уровень содержит различные протоколы, которые используются для обмена данными между приложениями, работающими на разных устройствах в сети. На этом уровне используются такие протоколы, как HTTP, FTP, SMTP и DNS.

## ORM (Object-Relational Mapping)

ORM — это технология программирования, которая создает слой между реляционными базами данных и объектно-ориентированными языками программирования без необходимости написания SQL-запросов.

Отображение объясняет, как объекты связаны с разными таблицами, используя эту информацию для преображения данных между ними. ORM генерирует код SQL для реляционной базы данных в ответ на изменения, которые приложение вносит в объект данных. Сопоставление ORM будет управлять потребностями приложения в данных, избавляя от написания низкоуровневого кода.

## DI (Dependency Injection)

Внедрение зависимостей — это стиль настройки объекта, при котором поля объекта задаются внешней сущностью. Другими словами, объекты настраиваются внешними объектами. DI — это альтернатива самонастройке объектов.

## Авторизация

Вообще, есть 3 шага:

* Идентификация — это процесс, когда система определяет, существует конкретный пользователь или нет. Делает она это с помощью идентификатора.
* Аутентификация — это процесс, когда пользователь вводит ключ подтверждая своё право на доступ к той или иной учётной записи и хранящейся в ней информации.
* Авторизация — проверка, что вам разрешен доступ к запрашиваемому ресурсу. Например, простой пользователь не сможет получить доступ к панели администрирования.

### Протоколы авторизации

* Аутентификация по паролю
* Аутентификация по сертификатам
* Аутентификация по токенам
* Стандарты OAuth и OpenID Connect